/*! elasticsearch-gui - v2.0.0 - 2015-11-26
* https://github.com/jettro/elasticsearch-gui
* Copyright (c) 2015 ; Licensed  */

!function(){"use strict";angular.module("guiapp.aggregatedialog",[])}(),function(){"use strict";var a=angular.module("guiapp",["ngRoute","guiapp.filters","guiapp.directives","ui.bootstrap","elasticsearch","gridshore.c3js.chart","guiapp.services","guiapp.dashboard","guiapp.navbar","guiapp.search","guiapp.aggregatedialog","guiapp.snapshot","guiapp.nodeinfo","guiapp.graph","guiapp.inspect","guiapp.monitoring","guiapp.notification","guiapp.suggestion","guiapp.whereshards","guiapp.query"]);a.config(["$routeProvider",function(a){a.when("/about",{templateUrl:"partials/about.html"}),a.otherwise({redirectTo:"/dashboard"})}]),a.value("localStorage",window.localStorage)}(),function(){"use strict";angular.module("guiapp.dashboard",["guiapp.services","ngRoute"])}(),function(){"use strict";angular.module("guiapp.graph",["guiapp.services","ngRoute","guiapp.aggregatedialog"])}(),function(){"use strict";angular.module("guiapp.inspect",["guiapp.services","ngRoute"])}(),function(){"use strict";angular.module("guiapp.monitoring",["guiapp.services","ngRoute"])}(),function(){"use strict";angular.module("guiapp.navbar",["guiapp.services"])}(),function(){"use strict";angular.module("guiapp.nodeinfo",["guiapp.services","ngRoute"])}(),function(){"use strict";angular.module("guiapp.notification",[])}(),function(){"use strict";angular.module("guiapp.query",["guiapp.services","ngRoute"])}(),function(){"use strict";angular.module("guiapp.search",["guiapp.services","ngRoute"])}(),function(){"use strict";function a(a){a.loadConfiguration()}angular.module("guiapp.services",["elasticsearch"]).value("version","2.0.0").run(a),a.$inject=["configuration"]}(),function(){"use strict";angular.module("guiapp.snapshot",["guiapp.services","ngRoute"])}(),function(){"use strict";angular.module("guiapp.suggestion",["guiapp.services","ngRoute"])}(),function(){"use strict";angular.module("guiapp.whereshards",["guiapp.services","ngRoute"])}(),function(){"use strict";function a(){function a(a){var b={};return angular.forEach(a,function(a){if("term"===a.aggsType)b[a.name]={terms:{field:a.field}};else if("range"===a.aggsType){for(var c=[],d=0;d<a.ranges.length;d++){var e=a.ranges[d];c.push(void 0==e[0]?{to:e[1]}:void 0==e[1]?{from:e[0]}:{from:e[0],to:e[1]})}b[a.name]={range:{field:a.field,ranges:c}}}else"datehistogram"===a.aggsType?b[a.name]={date_histogram:{field:a.field,interval:a.interval}}:"histogram"===a.aggsType&&(b[a.name]={histogram:{field:a.field,interval:a.interval}})}),b}return{build:a}}angular.module("guiapp.services").factory("aggregateBuilder",a)}(),function(){"use strict";function a(a,b,c){function d(){var a=b[g];if(a)f(JSON.parse(a));else{var d;d="www.gridshore.nl"==c.host()?"http://localhost:9200":c.protocol()+"://"+c.host()+":"+c.port(),f({title:void 0,description:void 0,excludedIndexes:void 0,includedIndexes:void 0,serverUrl:d})}}function e(a){f(a),b[g]=JSON.stringify(i.configuration)}function f(a){a.title&&a.title.length>0&&(i.configuration.title=a.title),a.description&&a.description.length>0&&(i.configuration.description=a.description),a.excludedIndexes&&a.excludedIndexes.length>0&&(i.configuration.excludedIndexes=a.excludedIndexes),a.includedIndexes&&a.includedIndexes.length>0&&(i.configuration.includedIndexes=a.includedIndexes),a.serverUrl&&a.serverUrl.length>0&&(i.configuration.serverUrl=a.serverUrl)}var g="es-config",h={},i={configuration:h,loadConfiguration:d,changeConfiguration:e};return i}angular.module("guiapp.services").factory("configuration",a),a.$inject=["$rootScope","localStorage","$location"]}(),function(){"use strict";function a(a,b,c,d){function e(a){J=a,L=F(),k()}function f(a){L.cluster.health({}).then(function(b){var c=b.number_of_nodes-b.number_of_data_nodes,d=b.cluster_name+" [nodes: "+b.number_of_nodes+", clients: "+c+"]";a(d,K[b.status])},function(b){I(b),a("No connection","error")})}function g(a){L.cluster.health().then(function(b){a(b)})}function h(a){L.nodes.info().then(function(b){a(b.nodes)})}function i(a){L.cluster.state({metric:["routing_table","nodes"]}).then(function(b){a(b.nodes,b.routing_table.indices)})}function j(a,b){L.nodes.info({nodeId:a,human:!0}).then(function(c){b(c.nodes[a])})}function k(a){L.cluster.state({ignoreUnavailable:!0}).then(function(b){var c=[];for(var d in b.metadata.indices){{G(d)}G(d)&&c.push(d)}M=c,a&&a(c)})}function l(a,b){L.indices.delete({index:a}).then(function(){b()})}function m(a,b){L.indices.open({index:a}).then(function(){b()})}function n(a,b){L.indices.close({index:a}).then(function(){b()})}function o(a){L.indices.stats({human:!0,recovery:!1}).then(function(b){var c=b.indices;L.cluster.state({metric:"metadata"}).then(function(b){var d=b.metadata.indices,e=[];angular.forEach(d,function(a,b){var d={};d.name=b,"open"===a.state?(c[b]?(d.size=c[b].total.store.size,d.numDocs=c[b].total.docs.count):(d.size="unknown",d.numDocs="unknown"),d.state=!0,d.numShards=a.settings.index.number_of_shards,d.numReplicas=a.settings.index.number_of_replicas):d.state=!1,e.push(d)}),a(e)})})}function p(a,b){var c={};a.length>0&&(c.index=a.toString()),L.indices.getMapping(c).then(function(a){var c=[];for(var d in a)if(G(d))for(var e in a[d].mappings)-1==c.indexOf(e)&&"_default_"!=e&&c.push(e);b(c)})}function q(a,b,c,d){L.termvectors({index:a,type:b,id:c,routing:c,body:{fields:["*"],field_statistics:!1,term_statistics:!0}}).then(function(a){var b={};a.term_vectors&&(angular.forEach(a.term_vectors,function(a,c){var d=[];angular.forEach(a.terms,function(a,b){d.push(b)}),b[c]=d}),d(b))})}function r(a,b,c){var d={};a.length>0&&(d.index=a.toString()),b.length>0&&(d.type=b.toString()),L.indices.getMapping(d).then(function(a){var b=[],d={};for(var e in a)if(G(e))for(var f in a[e].mappings)if(-1==b.indexOf(f)&&"_default_"!=f){b.push(f);var g=a[e].mappings[f].properties;for(var h in g)B(g[h],h,d,void 0)}c(d)})}function s(a,b,c){var d={index:a,body:{index:{number_of_replicas:b}}};L.indices.putSettings(d).then(function(a){c(a)},H)}function t(a){L.snapshot.getRepository().then(function(b){a(b)},H)}function u(a,b){var c={repository:a.repository,body:{type:"fs",settings:{location:a.location}}};L.snapshot.createRepository(c).then(function(){b()},I)}function v(a,b){L.snapshot.deleteRepository({repository:a}).then(function(){b()},I)}function w(a,b){L.snapshot.get({repository:a,snapshot:"_all"}).then(function(a){b(a.snapshots)},H)}function x(a){L.snapshot.status().then(function(b){a(b.snapshots)},H)}function y(a,b,c){L.snapshot.delete({repository:a,snapshot:b}).then(function(){c()},H)}function z(a,b,c){L.snapshot.restore({repository:a,snapshot:b}).then(function(){c()},I)}function A(a,b){var c={repository:a.repository,snapshot:a.snapshot,body:{indices:a.indices,ignore_unavailable:a.ignoreUnavailable,include_global_state:a.includeGlobalState}};L.snapshot.create(c).then(function(){b()},H)}function B(a,b,c,d){if(a.hasOwnProperty("properties")){var e="nested"==a.type|"object"==a.type;e&&(d=b);for(var f in a.properties){var g=b+"."+f;B(a.properties[f],g,c,d)}}else{if(a.hasOwnProperty("fields"))for(var h in a.fields){var i=b+"."+h;c[i]||b===h||(c[i]=a.fields[h],c[i].nestedPath=d,c[i].forPrint=i+" ("+a.type+")")}c[b]||(c[b]=a,c[b].nestedPath=d,c[b].type=a.type,c[b].forPrint=b+" ("+a.type+")")}}function C(a,b,c){""===a.index&&(a.index=M),L.search(a).then(function(a){b(a)},function(a){c(a)})}function D(a,b,c,d,e){L.get({index:a,type:b,id:c}).then(function(a){d(a)},function(a){e(a)})}function E(a,b){var c={};c.index=a.index,c.body={},c.body.mysuggester={},c.body.mysuggester.text=a.query,c.body.mysuggester.term={},c.body.mysuggester.term.field=a.field,c.body.mysuggester.term.min_word_length=a.min_word_length,c.body.mysuggester.term.prefix_length=a.prefix_length,L.suggest(c).then(function(a){var c={};if(a.mysuggester)for(var d=0;d<a.mysuggester.length;d++){var e=a.mysuggester[d];c[e.text]=[];for(var f=0;f<e.options.length;f++)c[e.text].push(e.options[f].text)}b(c)},H)}function F(){return a({host:J,apiVersion:"2.0"})}function G(a){var c=!1;if(b.configuration.includedIndexes&&b.configuration.includedIndexes.length>0){c=!0;var d=b.configuration.includedIndexes?b.configuration.includedIndexes.split(","):[];angular.forEach(d,function(b){var d=b.trim();a.substring(0,d.length)===d&&(c=!1)})}else{var e=b.configuration.excludedIndexes?b.configuration.excludedIndexes.split(","):[];angular.forEach(e,function(b){var d=b.trim();a.substring(0,d.length)===d&&(c=!0)})}return!c}function H(a){d.error(a)}function I(a){c.$broadcast("msg:notification","error",a.message)}var J=b.configuration.serverUrl,K={green:"success",yellow:"warning",red:"error"},L=F(),M=[],N={changeServerAddress:e,obtainServerAddress:function(){return J},clusterStatus:f,clusterHealth:g,clusterNodes:h,obtainShards:i,nodeInfo:j,indexes:k,removeIndex:l,openIndex:m,closeIndex:n,indexesDetails:o,types:p,documentTerms:q,fields:r,changeReplicas:s,snapshotRepositories:t,createRepository:u,deleteRepository:v,obtainSnapshots:w,obtainSnapshotStatus:x,removeSnapshot:y,restoreSnapshot:z,createSnapshot:A,doSearch:C,suggest:E,getDocument:D};return N}angular.module("guiapp.services").factory("elastic",a),a.$inject=["esFactory","configuration","$rootScope","$log"]}(),function(){"use strict";function a(a){function b(b){var c;b&&"object"==typeof b?b.hasOwnProperty("message")&&(c=b.message):c=b,a.$broadcast("msg:notification","error",c)}var c={add:b};return c}angular.module("guiapp.services").factory("errorHandling",a),a.$inject=["$rootScope"]}(),function(){"use strict";function a(){return{name:"unknown",numreplicas:0}}angular.module("guiapp.services").factory("indexService",a)}(),function(){"use strict";function a(a){function b(b){var c=a[f];b(JSON.parse(c))}function c(b){a[f]=JSON.stringify(b)}function d(b){var c=a[g];b(JSON.parse(c))}function e(b){a[g]=JSON.stringify(b)}var f="es-query",g="es-search",h={loadQuery:b,saveQuery:c,loadSearch:d,saveSearch:e};return h}angular.module("guiapp.services").factory("queryStorage",a),a.$inject=["localStorage"]}(),function(){"use strict";function a(a){function b(){c.host="www.gridshore.nl"==a.host()?"http://localhost:9200":a.protocol()+"://"+a.host()+":"+a.port()}var c={host:"",initHost:b};return c}angular.module("guiapp.services").factory("IKWORDNIETGEBRUIKT",a),a.$inject=["$location"]}(),function(){"use strict";function a(a,b){function c(b){var c={};c.field=b.field,c.name=b.name,"Term"===b.aggstype?c.aggsType="term":"Range"===b.aggstype?(c.aggsType="range",c.ranges=e.ranges):"DateHistogram"===b.aggstype?(c.aggsType="datehistogram",c.interval=b.interval):"Histogram"===b.aggstype&&(c.aggsType="histogram",c.interval=b.interval),a.close(c)}function d(a){e.ranges.push([a.range.from,a.range.to])}var e=this;e.fields=b,e.aggsTypes=["Term","Range","Histogram","DateHistogram"],e.ranges=[],e.intervals=["year","month","week","day","hour","minute"],e.close=c,e.addRangeField=d}angular.module("guiapp.aggregatedialog").controller("AggregateDialogCtrl",a),a.$inject=["$modalInstance","fields"]}(),function(){"use strict";function a(a,b){function c(b){a.close(b)}var d=this;d.dialog={numReplicas:b.numReplicas,name:b.name},d.close=c}angular.module("guiapp.dashboard").controller("ChangeNumReplicasCtrl",a),a.$inject=["$modalInstance","indexService"]}(),function(){"use strict";function a(a,b,c,d){function e(a){b.closeIndex(a,function(){i()})}function f(a){b.openIndex(a,function(){i()})}function g(a){d.name=a.name,!isNaN(parseInt(a.numReplicas))&&isFinite(a.numReplicas)&&(d.numReplicas=parseInt(a.numReplicas));var e={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"template/dialog/numreplicas.html",controller:"ChangeNumReplicasCtrl",controllerAs:"cnrVm",resolve:{fields:function(){return angular.copy(d)}}},f=c.open(e);f.result.then(function(a){a&&b.changeReplicas(a.name,a.numReplicas,function(){i()})},function(){})}function h(a){b.removeIndex(a,function(){i()})}function i(){b.indexesDetails(function(a){k.indices=a})}function j(){k.serverUrl=b.obtainServerAddress(),b.clusterHealth(function(a){k.health=a}),b.clusterNodes(function(a){k.nodes=a})}var k=this;k.health={},k.nodes=[],k.plugins=[],k.serverUrl="",k.closeIndex=e,k.openIndex=f,k.openChangeReplicas=g,k.removeIndex=h,a.$on("$viewContentLoaded",function(){i(),j()})}angular.module("guiapp.dashboard").controller("DashboardCtrl",a),a.$inject=["$scope","elastic","$modal","indexService"]}(),function(){"use strict";function a(a){a.when("/dashboard",{templateUrl:"partials/dashboard.html",controller:"DashboardCtrl",controllerAs:"vm"})}angular.module("guiapp.dashboard").config(a),a.$inject=["$routeProvider"]}(),angular.module("guiapp.directives",[]).directive("appVersion",["version",function(a){return function(b,c){c.text(a)}}]).directive("ngConfirmClick",[function(){return{link:function(a,b,c){var d=c.ngConfirmClick||"Are you sure?",e=c.confirmedClick;b.bind("click",function(){window.confirm(d)&&a.$eval(e)})}}}]),function(){"use strict";function a(a){a.decorator("$exceptionHandler",b)}function b(a,b){return function(c,d){a(c,d);b.error(c.msg)}}angular.module("guiapp").config(a),a.$inject=["$provide"],b.$inject=["$delegate","$log"]}(),angular.module("guiapp.filters",[]).filter("interpolate",["version",function(a){return function(b){return String(b).replace(/\%VERSION\%/gm,a)}}]),function(){"use strict";function a(a,b,c,d){function e(){f(),g(),h()}function f(){b.indexes(function(a){l.indices=a})}function g(){b.types([],function(a){l.types=a})}function h(){b.fields([],[],function(a){l.fields=a})}function i(){var b={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"template/dialog/aggregate.html",controller:"AggregateDialogCtrl",controllerAs:"adVm",resolve:{fields:function(){return angular.copy(l.fields)}}},c=a.open(b);c.result.then(function(a){a&&(l.aggregate=a,j())})}function j(){var a=k();b.doSearch(a,function(a){if("term"===l.aggregate.aggsType){l.columns=[];var b={};angular.forEach(a.aggregations[l.aggregate.name].buckets,function(a){l.columns.push({id:a.key,type:"pie",name:a.key+"["+a.doc_count+"]"}),b[a.key]=a.doc_count}),l.results=[b]}else"datehistogram"===l.aggregate.aggsType?(l.columns=[{id:"doc_count",type:"line",name:"documents"}],l.xaxis={id:"key"},l.results=a.aggregations[l.aggregate.name].buckets):(l.columns=[{id:"doc_count",type:"bar",name:"documents"}],l.xaxis={id:"key"},l.results=a.aggregations[l.aggregate.name].buckets)},function(a){d.error(a)})}function k(){var a={};a.index="",a.body={},a.size=0,a.body.query={matchAll:{}};var b=[];return b.push(l.aggregate),a.body.aggs=c.build(b),a}var l=this;l.indices=[],l.types=[],l.fields=[],l.results=[],l.columns=[],l.loadIndices=f,l.loadTypes=g(),l.loadFields=h,l.openDialog=i,l.executeQuery=j,e()}angular.module("guiapp").controller("GraphCtrl",a),a.$inject=["$modal","elastic","aggregateBuilder","$log"]}(),function(){"use strict";function a(a){a.when("/graph",{templateUrl:"partials/graph.html",controller:"GraphCtrl",controllerAs:"vm"})}angular.module("guiapp.graph").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a,b,c,d){function e(){b.id&&b.type&&b.index&&(i.inspect.id=b.id,d.getDocument(b.index,b.type,b.id,function(a){i.result=a},function(a){i.metaResults={},i.metaResults.failedShards=1,i.metaResults.errors=[],i.metaResults.errors.push(a.error)})),g(),a.$watch("vm.inspect.index",function(){h()})}function f(){c.path("/inspect/"+i.inspect.index.name+"/"+i.inspect.type.name+"/"+i.inspect.id)}function g(){d.indexes(function(a){if(a)for(var c=0;c<a.length;c++)i.sourcedata.indices[c]={name:a[c]},b.index&&b.index==a[c]&&(i.inspect.index=i.sourcedata.indices[c]);else i.sourcedata.indices=[]})}function h(){d.types(i.inspect.index,function(a){if(a)for(var c=0;c<a.length;c++)i.sourcedata.types[c]={name:a[c]},b.type&&b.type==a[c]&&(i.inspect.type=i.sourcedata.types[c]);else i.sourcedata.types=[]})}var i=this;i.inspect={},i.inspect.index="",i.inspect.type="",i.inspect.id="",i.sourcedata={},i.sourcedata.indices=[],i.sourcedata.types=[],i.doInspect=f,i.loadIndices=g,e()}angular.module("guiapp.inspect").controller("InspectCtrl",a),a.$inject=["$scope","$routeParams","$location","elastic"]}(),function(){"use strict";function a(a){a.when("/inspect/:index/:type/:id",{templateUrl:"partials/inspect.html",controller:"InspectCtrl",controllerAs:"vm"}).when("/inspect",{templateUrl:"partials/inspect.html",controller:"InspectCtrl",controllerAs:"vm"})}angular.module("guiapp.inspect").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a,b){var c=this;c.dataNodes=[],c.columnsNodes=[{id:"num-nodes",type:"line",name:"Number of nodes"}],c.datax={id:"x"},c.dataShards=[],c.columnsShards=[{id:"num-shards-primary",type:"line",name:"Primary"},{id:"num-shards-active",type:"line",name:"Active"},{id:"num-shards-relocating",type:"line",name:"Relocating"},{id:"num-shards-initializing",type:"line",name:"Initializing"},{id:"num-shards-unassigned",type:"line",name:"Unassigned"}],c.dataxShards={id:"xShards"},c.numPoints=10,c.lengthDelay=5e3;var d;c.loadNodes=function(){d=b(function(){a.clusterNodes(function(a){c.dataNodes.length>=c.numPoints&&(c.dataNodes=c.dataNodes.splice(1,c.numPoints)),c.dataNodes.push({x:new Date,"num-nodes":Object.keys(a).length})}),a.clusterHealth(function(a){c.dataShards.length>=c.numPoints&&(c.dataShards=c.dataShards.splice(1,c.numPoints)),c.dataShards.push({xShards:new Date,"num-shards-primary":a.active_primary_shards,"num-shards-active":a.active_shards,"num-shards-relocating":a.relocating_shards,"num-shards-initializing":a.initializing_shards,"num-shards-unassigned":a.unassigned_shards})})},c.lengthDelay)},c.loadNodes()}angular.module("guiapp.monitoring").controller("MonitoringCtrl",a),a.$inject=["elastic","$interval"]}(),function(){"use strict";function a(a){a.when("/tools/monitoring",{templateUrl:"partials/monitoring.html",controller:"MonitoringCtrl",controllerAs:"vm"})}angular.module("guiapp.monitoring").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a,b){function c(){e.configuration.serverUrl=b.configuration.serverUrl,e.configuration.excludedIndexes=b.configuration.excludedIndexes,e.configuration.includedIndexes=b.configuration.includedIndexes}function d(){a.close(e.configuration)}var e=this;e.configuration={},e.close=d,c()}angular.module("guiapp.navbar").controller("ConfigDialogCtrl",a),a.$inject=["$modalInstance","configuration"]}(),function(){"use strict";function a(a,b,c,d){function e(a){m.push(a)}function f(a){angular.forEach(m,function(a){a.selected=!1}),a.selected=!0}function g(a){angular.forEach(m,function(b){b.link==a.split("/")[1]&&f(b)})}function h(){c.changeServerAddress(l.serverUrl),d.excludedIndexes=l.configure.excludedIndexes}function i(){k()}function j(){var a={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"template/dialog/config.html",controller:"ConfigDialogCtrl",controllerAs:"confVm",resolve:{fields:function(){return angular.copy(d)}}},e=b.open(a);e.result.then(function(a){a&&(c.changeServerAddress(a.serverUrl),d.changeConfiguration(angular.copy(a)))},function(){})}function k(){c.clusterStatus(function(a,b){l.statusCluster.message=a,l.statusCluster.state=b}),a(function(){k()},5e3)}var l=this;l.statusCluster={},l.serverUrl=c.obtainServerAddress(),l.configureServerUrl=!1,l.configure=d;var m=[];l.addItem=e,l.changeServerUrl=h,l.initNavbar=i,l.openDialog=j,l.select=f,l.selectByUrl=g,k()}angular.module("guiapp.navbar").controller("NavbarCtrl",a),a.$inject=["$timeout","$modal","elastic","configuration"]}(),function(){"use strict";angular.module("guiapp.navbar").directive("navbar",["$location",function(a){return{restrict:"E",transclude:!0,scope:{heading:"@"},controller:"NavbarCtrl",controllerAs:"vm",templateUrl:"template/navbar/navbar.html",replace:!0,link:function(b,c,d,e){b.$location=a,b.$watch("$location.path()",function(a){e.selectByUrl(a)})}}}]).directive("navbaritem",[function(){return{require:"^navbar",restrict:"E",templateUrl:"template/navbar/navbaritem.html",replace:!0,scope:{theLink:"@link",theTitle:"@title"},link:function(a,b,c,d){a.item={title:c.title,link:c.link,selected:!1},d.addItem(a.item)}}}]).directive("navbardropdownitem",[function(){return{require:"^navbar",restrict:"E",scope:{theLink:"@link",theTitle:"@title"},templateUrl:"template/navbar/navbardropdownitem.html",replace:!0,link:function(){}}}]).directive("navbardropdown",[function(){return{require:"^navbar",restrict:"E",transclude:!0,scope:{theTitle:"@title",theLink:"@link"},templateUrl:"template/navbar/navbardropdown.html",replace:!0,link:function(a,b,c,d){a.item={title:a.theTitle,link:a.theLink,selected:!1},d.addItem(a.item)}}}])}(),function(){"use strict";function a(a,b){function c(){a.nodeInfo(e,function(a){d.nodes=a})}var d=this,e=b.nodeId;c()}angular.module("guiapp.nodeinfo").controller("NodeInfoCtrl",a),a.$inject=["elastic","$routeParams"]}(),function(){"use strict";function a(a){a.when("/node/:nodeId",{templateUrl:"partials/node.html",controller:"NodeInfoCtrl",controllerAs:"vm"})}angular.module("guiapp.nodeinfo").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a,b){function c(a,c,e){var f=Math.random().toString(36).substring(2,5);d.alerts[f]={type:c,message:e},b(function(){delete d.alerts[f]},1e4)}var d=this;d.alerts={},a.$on("msg:notification",c)}angular.module("guiapp.notification").controller("NotificationCtrl",a),a.$inject=["$rootScope","$timeout"]}(),function(){"use strict";function a(){var a={restrict:"E",transclude:!0,controller:"NotificationCtrl",controllerAs:"vm",templateUrl:"template/notification/notification.html",replace:!0};return a}angular.module("guiapp.notification").directive("guiappnotification",a)}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){h(),i(),l(),a.$watchCollection("vm.query",function(){w()})}function h(){F.query={},F.query.term="",F.query.chosenFields=[],F.query.aggs={},F.query.indices={},F.query.types={},F.query.advanced={},F.query.advanced.searchFields=[],F.query.advanced.newType="or",F.query.advanced.newText=null,F.query.advanced.newField=null,F.query.multiSearch=!1}function i(){F.currentPage=1,F.maxSize=5,F.numPages=0,F.pageSize=10,F.totalItems=0}function j(){u()}function k(){F.currentPage=1,F.numPages=0,F.pageSize=10,F.totalItems=0,F.executeQuery()}function l(){F.unbind.indicesScope(),d.indexes(function(b){if(b){for(var c=0;c<b.length;c++)F.query.indices[b[c]]={name:b[c],state:!1};F.unbind.indicesScope=a.$watch("vm.query.indices",F.loadTypes,!0)}else F.query.indices={}})}function m(){F.query.types={};var b=[];angular.forEach(F.query.indices,function(a){a.state&&b.push(a.name)}),F.unbind.typesScope(),d.types(b,function(b){if(b){for(var c=0;c<b.length;c++)F.query.types[b[c]]={name:b[c],state:!1};F.unbind.typesScope=a.$watch("vm.query.types",F.loadFields,!0)}else F.query.types={}})}function n(){var a=[];angular.forEach(F.query.indices,function(b){b.state&&a.push(b.name)});var b=[];angular.forEach(F.query.types,function(a){a.state&&b.push(a.name)}),d.fields(a,b,function(a){F.fields=a})}function o(){var a=F.query.chosenFields.indexOf(F.queryFactory.addField);-1==a&&F.query.chosenFields.push(F.queryFactory.addField),w()}function p(){angular.forEach(F.fields,function(a,b){F.query.chosenFields.push(b)}),w()}function q(a){F.query.chosenFields.splice(a,1),w()}function r(){var a={};a.field=F.query.advanced.newField,a.text=F.query.advanced.newText,a.type=F.query.advanced.newType,F.query.advanced.searchFields.push(a)}function s(a){F.query.advanced.searchFields.splice(a,1)}function t(a){delete F.query.aggs[a],w()}function u(){w();var a=B();F.metaResults={},d.doSearch(a,function(a){F.queryResults=a.hits,F.aggsResults=a.aggregations,F.numPages=Math.ceil(a.hits.total/F.pageSize),F.totalItems=a.hits.total,F.metaResults.totalShards=a._shards.total,a._shards.failed>0&&(F.metaResults.failedShards=a._shards.failed,F.metaResults.errors=[],angular.forEach(a._shards.failures,function(a){F.metaResults.errors.push(a.index+" - "+a.reason)}))},function(a){F.metaResults.failedShards=1,F.metaResults.errors=[],F.metaResults.errors.push(a.error)})}function v(){l(),h(),i(),w(),F.query.type="or"}function w(){F.createdQuery=JSON.stringify(B().body,null,2)}function x(){var a={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"template/dialog/aggregate.html",controller:"AggregateDialogCtrl",controllerAs:"adVm",resolve:{fields:function(){return angular.copy(F.fields)}}},c=b.open(a);c.result.then(function(a){a&&(F.query.aggs[a.name]=a,w())})}function y(){f.saveQuery(angular.copy(F.query))}function z(){f.loadQuery(function(a){F.query=angular.copy(a),w()})}function A(a){c.path("/inspect/"+a._index+"/"+a._type+"/"+a._id)}function B(){var a={};a.index="",a.body={},a.body.query={},a.size=F.pageSize,a.from=(F.currentPage-1)*F.pageSize;var b=[];angular.forEach(F.query.indices,function(a){a.state&&b.push(a.name)}),a.index=b.toString();var c=[];if(angular.forEach(F.query.types,function(a){a.state&&c.push(a.name)}),a.type=c.toString(),F.query.chosenFields.length>0&&(a.fields=F.query.chosenFields.toString()),F.query.multiSearch&&F.query.advanced.searchFields.length>0){for(var d={},f=0;f<F.query.advanced.searchFields.length;f++){var g=F.query.advanced.searchFields[f],h=F.fields[g.field];E(d,g.field,g.text,g.type),h.nestedPath&&D(d,h.nestedPath,h.nestedPath)}a.body.query=C(d)}else if(F.query.term.length>0){var i={};i.query=F.query.term,"phrase"===F.query.type?i.type="phrase":i.operator=F.query.type,a.body.query.match={_all:i}}else a.body.query.matchAll={};if(a.body.aggs=e.build(F.query.aggs),a.body.explain=F.query.explain,F.query.highlight){var j={fields:{}};angular.forEach(F.query.chosenFields,function(a){j.fields[a]={}}),a.body.highlight=j}return a}function C(a){var b=Object.getOwnPropertyNames(a),c={};c.bool={},c.bool.must=[];for(var d=0;d<b.length;d++){var e=b[d];if(a[e]instanceof Object)c.bool.must.push(C(a[e]));else if("_"!==e.substring(0,1)){var f=e;a._nested&&(f=a._nested+"."+f);var g={};g[f]={},g[f].query=a[e],"phrase"===F.query.type?g[f].type="phrase":g[f].operator=a["_type_"+e],c.bool.must.push({match:g})}}var h;if(a._nested){var i={};i.nested={},i.nested.path=a._nested,i.nested.query=c,h=i}else h=c;return h}function D(a,b,c){var d=b.split(".");d.length>1?D(a[d[0]],d.splice(1).join("."),c):a[b]._nested=c}function E(a,b,c,d){var e=b.split(".");e.length>1?(a.hasOwnProperty(e[0])||(a[e[0]]={}),E(a[e[0]],e.splice(1).join("."),c,d)):a.hasOwnProperty(b)||(a[b]=c,a["_type_"+b]=d)}var F=this;F.fields=[],F.createdQuery="",F.queryResults=[],F.aggsResults=[],F.metaResults={},F.queryFactory={},F.unbind={},F.unbind.indicesScope=function(){},F.unbind.typesScope=function(){},F.changePage=j,F.restartSearch=k,F.loadIndices=l,F.loadTypes=m,F.loadFields=n,F.addQueryField=o,F.addAllQueryFields=p,F.removeQueryField=q,F.addSearchField=r,F.removeSearchField=s,F.removeAggregateField=t,F.executeQuery=u,F.resetQuery=v,F.changeQuery=w,F.openDialog=x,F.saveQuery=y,F.loadQuery=z,F.inspect=A,g()}angular.module("guiapp.query").controller("QueryCtrl",a),a.$inject=["$scope","$modal","$location","elastic","aggregateBuilder","queryStorage"]}(),function(){"use strict";function a(a){a.when("/query",{templateUrl:"partials/query.html",controller:"QueryCtrl",controllerAs:"vm"})}angular.module("guiapp.query").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a,b,c,d,e,f){function g(){i()}function h(){F.doSearch()}function i(){F.configure.title=c.configuration.title,F.configure.description=c.configuration.description,b.fields([],[],function(a){F.fields=a,F.configure.title||F.fields.title&&(F.configure.title="title"),!F.configure.description&&F.fields.description&&(F.configure.description="description")}),a.$watchCollection("vm.configure",function(){c.changeConfiguration(F.configure)},!0)}function j(){F.currentPage=1,F.numPages=0,F.pageSize=10,F.totalItems=0,F.tokensPerField=[],F.doSearch()}function k(){F.configError=F.configure.title&&F.configure.description?"":"Please configure the title and description in the configuration at the top of the page.";var a={};a.index="",a.body={},a.size=F.pageSize,a.from=(F.currentPage-1)*F.pageSize,a.body.aggs=d.build(F.search.aggs);var c=D();a.body.query=c?{filtered:{query:z(),filter:c}}:z(),b.doSearch(a,function(a){F.results=a.hits,F.aggs=a.aggregations,F.numPages=Math.ceil(a.hits.total/F.pageSize),F.totalItems=a.hits.total,F.metaResults.totalShards=a._shards.total,a._shards.failed>0&&(F.metaResults.failedShards=a._shards.failed,F.metaResults.errors=[],angular.forEach(a._shards.failures,function(a){F.metaResults.errors.push(a.index+" - "+a.reason)}))},E)}function l(){var a={};a.field=F.search.advanced.newField,a.text=F.search.advanced.newText,F.search.advanced.searchFields.push(a)}function m(a){F.search.advanced.searchFields.splice(a,1)}function n(){var a={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"template/dialog/aggregate.html",controller:"AggregateDialogCtrl",controllerAs:"adVm",resolve:{fields:function(){return angular.copy(F.fields)}}},b=e.open(a);b.result.then(function(a){a&&(F.search.aggs[a.name]=a)},function(){})}function o(a){delete F.search.aggs[a]}function p(){f.saveSearch(angular.copy(F.search))}function q(){f.loadSearch(function(a){F.search=angular.copy(a)})}function r(a,b){F.search.selectedAggs||(F.search.selectedAggs=[]),F.search.selectedAggs.push({key:a,value:b}),F.doSearch()}function s(a,b,c){F.search.selectedAggs||(F.search.selectedAggs=[]),F.search.selectedAggs.push({key:a,from:b,to:c}),F.doSearch()}function t(a,b){if(!F.search.selectedAggs)return!1;for(var c=0;c<F.search.selectedAggs.length;c++){var d=F.search.selectedAggs;if(d[c].key===a&&d[c].value===b)return!0}return!1}function u(a,b,c){if(!F.search.selectedAggs)return!1;for(var d=0;d<F.search.selectedAggs.length;d++){var e=F.search.selectedAggs;if(e[d].key===a&&e[d].from===b&&e[d].to===c)return!0}return!1}function v(a,b){if(F.search.selectedAggs){for(var c=0;c<F.search.selectedAggs.length;c++){var d=F.search.selectedAggs;d[c].key===a&&d[c].value===b&&F.search.selectedAggs.splice(c,1)}F.doSearch()}}function w(a,b,c){if(F.search.selectedAggs){for(var d=0;d<F.search.selectedAggs.length;d++){var e=F.search.selectedAggs;e[d].key===a&&e[d].from===b&&e[d].to===c&&F.search.selectedAggs.splice(d,1)}F.doSearch()}}function x(a){for(var b=0;b<F.search.aggs.length;b++){var c=F.search.aggs[b];if(c.field===a)return c}return null}function y(a,c,d){F.tokensPerField={id:a+c+d},b.documentTerms(a,c,d,function(a){F.tokensPerField.tokens=a})}function z(){var a;if(F.search.doAdvanced&&F.search.advanced.searchFields.length>0){for(var b={},c=0;c<F.search.advanced.searchFields.length;c++){var d=F.search.advanced.searchFields[c],e=F.fields[d.field];C(b,d.field,d.text),e.nestedPath&&B(b,e.nestedPath,e.nestedPath)}a=A(b)}else a=F.search.simple&&F.search.simple.length>0?{simple_query_string:{query:F.search.simple,fields:["_all"],analyzer:"snowball"}}:{matchAll:{}};return a}function A(a){var b=Object.getOwnPropertyNames(a),c={};c.bool={},c.bool.must=[];for(var d=0;d<b.length;d++){var e=b[d];if(a[e]instanceof Object)c.bool.must.push(A(a[e]));else if("_"!==e.substring(0,1)){var f=e;a._nested&&(f=a._nested+"."+f);var g={};g[f]=a[e],c.bool.must.push({match:g})}}var h;if(a._nested){var i={};i.nested={},i.nested.path=a._nested,i.nested.query=c,h=i}else h=c;return h}function B(a,b,c){var d=b.split(".");d.length>1?B(a[d[0]],d.splice(1).join("."),c):a[b]._nested=c}function C(a,b,c){var d=b.split(".");d.length>1?(a.hasOwnProperty(d[0])||(a[d[0]]={}),C(a[d[0]],d.splice(1).join("."),c)):a.hasOwnProperty(b)||(a[b]=c)}function D(){if(F.search.selectedAggs&&F.search.selectedAggs.length>0){for(var a={},b=F.search.selectedAggs,c=[],d=0;d<b.length;d++){var e=F.search.aggs[b[d].key],f=e.aggsType;if("term"===f){var g={term:{}};g.term[F.search.aggs[b[d].key].field]=b[d].value,c.push(g)}else if("datehistogram"===f){var h=new Date(b[d].value);"year"===e.interval?h.setFullYear(h.getFullYear()+1):"month"===e.interval?h.setMonth(h.getMonth()+1):"week"===e.interval?h.setDate(h.getDate()+7):"day"===e.interval?h.setDate(h.getDate()+1):"hour"===e.interval?h.setHours(h.getHours()+1):"minute"===e.interval&&h.setMinutes(h.getMinutes()+1);
var i={range:{}};i.range[F.search.aggs[b[d].key].field]={from:b[d].value,to:h.getTime()},c.push(i)}else if("histogram"===f){var i={range:{}},j=F.search.aggs[b[d].key];i.range[j.field]={from:b[d].value,to:b[d].value+j.interval-1},c.push(i)}else if("range"===f){var i={range:{}},j=F.search.aggs[b[d].key];i.range[j.field]={from:b[d].from,to:b[d].to},c.push(i)}}return a.and=c,a}return null}function E(a){F.metaResults.failedShards=1,F.metaResults.errors=[],a.message&&"object"==typeof a.message?a.message.hasOwnProperty("message")&&F.metaResults.errors.push(a.message.message):F.metaResults.errors.push(a.message)}var F=this;F.isCollapsed=!0,F.configure={},F.fields=[],F.search={},F.search.advanced={},F.search.advanced.searchFields=[],F.search.aggs={},F.search.selectedAggs=[],F.configError="",F.results=[],F.aggs=[],F.tokensPerField=[],F.metaResults={},F.currentPage=1,F.maxSize=5,F.numPages=0,F.pageSize=10,F.totalItems=0,F.addFilter=r,F.addRangeFilter=s,F.addSearchField=l,F.changePage=h,F.checkSelectedAggregate=t,F.checkSelectedRangeAggregate=u,F.doSearch=k,F.init=i,F.loadQuery=q,F.obtainAggregateByKey=x,F.openDialog=n,F.removeFilter=v,F.removeRangeFilter=w,F.removeSearchField=m,F.restartSearch=j,F.removeAggregateField=o,F.saveQuery=p,F.showAnalysis=y,g()}angular.module("guiapp.search").controller("SearchCtrl",a),a.$inject=["$scope","elastic","configuration","aggregateBuilder","$modal","queryStorage"]}(),function(){"use strict";function a(a){a.when("/search",{templateUrl:"partials/search.html",controller:"SearchCtrl",controllerAs:"vm"})}angular.module("guiapp.search").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a){function b(b){a.close(b)}var c=this;c.dialog={includeGlobalState:!0,ignoreUnavailable:!1},c.close=b}angular.module("guiapp.snapshot").controller("CreateSnapshotCtrl",a),a.$inject=["$modalInstance"]}(),function(){"use strict";function a(a){function b(b){a.close(b)}var c=this;c.dialog={},c.close=b}angular.module("guiapp.snapshot").controller("CreateSnapshotRepositoryCtrl",a),a.$inject=["$modalInstance"]}(),function(){"use strict";function a(a,b,c){function d(){e()}function e(){b.snapshotRepositories(function(a){n.repositories=a})}function f(a){n.selectedRepository=a}function g(a){b.deleteRepository(a,function(){n.selectedRepository===a&&(n.selectedRepository=""),e()})}function h(){""!==n.selectedRepository&&b.obtainSnapshotStatus(function(a){a.length>0?(n.snapshotsStatus=!0,n.snapshots=a):b.obtainSnapshots(n.selectedRepository,function(a){n.snapshotsStatus=!1,n.snapshots=a})})}function i(a){b.removeSnapshot(n.selectedRepository,a,function(){h()})}function j(a,c){b.removeSnapshot(a,c,function(){h()})}function k(a){b.restoreSnapshot(n.selectedRepository,a,function(){h()})}function l(){var a={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"template/dialog/createsnapshot.html",controller:"CreateSnapshotCtrl",controllerAs:"csVm"},d=c.open(a);d.result.then(function(a){if(a){var c={};if(c.repository=n.selectedRepository,a.name)c.snapshot=a.name;else{var d=moment().format("YYYYMMDDHHmmss");c.snapshot=a.prefix+"-"+d}c.indices=a.indices,c.ignoreUnavailable=a.ignoreUnavailable,c.includeGlobalState=a.includeGlobalState,b.createSnapshot(c,function(){h()})}},function(){})}function m(){var a={backdrop:!0,keyboard:!0,backdropClick:!0,templateUrl:"template/dialog/createsnapshotrepository.html",controller:"CreateSnapshotRepositoryCtrl",controllerAs:"csrVm"},d=c.open(a);d.result.then(function(a){a&&b.createRepository(a,function(){e(),n.selectedRepository=""})},function(){})}var n=this;n.repositories=[],n.selectedRepository="",n.snapshots=[],n.snapshotsStatus=!1,n.listSnapshots=h,n.selectRepository=f,n.deleteRepository=g,n.listrepositories=e,n.removeSnapshot=i,n.removeSnapshotFromRepository=j,n.restoreSnapshot=k,n.openCreateSnapshot=l,n.openCreateSnapshotRepository=m,d(),a.$watch("vm.selectedRepository",function(){h()})}angular.module("guiapp.snapshot").controller("SnapshotCtrl",a),a.$inject=["$scope","elastic","$modal"]}(),function(){"use strict";function a(a){a.when("/tools/snapshots",{templateUrl:"partials/snapshots.html",controller:"SnapshotCtrl",controllerAs:"vm"})}angular.module("guiapp.snapshot").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a,b){function c(){e()}function d(){var a={index:g.suggest.index.name,field:g.suggest.field,query:g.suggest.query,min_word_length:g.suggest.min_word_length,prefix_length:g.suggest.prefix_length};b.suggest(a,function(a){g.results=a})}function e(){g.unbind.indicesScope(),b.indexes(function(b){if(b){for(var c=0;c<b.length;c++)g.sourcedata.indices[c]={name:b[c]};g.unbind.indicesScope=a.$watch("vm.suggest.index",g.loadFields,!0)}else g.sourcedata.indices=[],g.sourcedata.fields=[]})}function f(){var a=[];g.suggest.index&&a.push(g.suggest.index.name);var c=[];b.fields(a,c,function(a){g.sourcedata.fields=a})}var g=this;g.suggest={},g.suggest.index="",g.suggest.field="",g.suggest.query="",g.suggest.min_word_length=3,g.suggest.prefix_length=1,g.sourcedata={},g.sourcedata.indices=[],g.sourcedata.fields=[],g.results={},g.unbind={},g.unbind.indicesScope=function(){},g.doSuggest=d,g.loadIndices=e,g.loadFields=f,c()}angular.module("guiapp.suggestion").controller("SuggestionCtrl",a),a.$inject=["$scope","elastic"]}(),function(){"use strict";function a(a){a.when("/tools/suggestions",{templateUrl:"partials/suggestions.html",controller:"SuggestionCtrl",controllerAs:"vm"})}angular.module("guiapp.suggestion").config(a),a.$inject=["$routeProvider"]}(),function(){"use strict";function a(a,b){function c(){d()}function d(){b.obtainShards(function(a,b){var c={};angular.forEach(b,function(a,b){angular.forEach(a.shards,function(a){angular.forEach(a,function(a){var d;d=a.primary?" (P)":" (R)",c[a.node]||(c[a.node]={}),c[a.node][b]||(c[a.node][b]=[]),c[a.node][b].push(a.shard+d)})})}),e.nodeInfo=a,e.shardsInfo=c}),a(function(){d()},5e3)}var e=this;e.shardsInfo={},e.nodeInfo={},c()}angular.module("guiapp").controller("WhereShardsCtrl",a),a.$inject=["$timeout","elastic"]}(),function(){"use strict";function a(a){a.when("/tools/whereareshards",{templateUrl:"partials/whereareshards.html",controller:"WhereShardsCtrl",controllerAs:"vm"})}angular.module("guiapp.whereshards").config(a),a.$inject=["$routeProvider"]}();
//# sourceMappingURL=elasticsearch-gui.min.js.map